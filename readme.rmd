# üî¨ RNA-seq Analysis: Mutant vs WildType in Drosophila melanogaster

Ce d√©p√¥t contient le pipeline complet d'analyse RNA-seq diff√©rentielle comparant des √©chantillons Mutants et WildType chez *Drosophila melanogaster* (DM6).

L'objectif de cette analyse √©tait d'identifier les g√®nes diff√©rentiellement exprim√©s (DEGs) suite √† la mutation, en utilisant une approche statistique rigoureuse via DESeq2.

## üíæ Acquisition et Donn√©es Brutes

Pour garantir une reproductibilit√© totale, les utilisateurs doivent t√©l√©charger les donn√©es brutes et les fichiers de r√©f√©rence √† partir des sources officielles.

1. Donn√©es Brutes RNA-seq (FastQ)

Les fichiers FastQ pour cette analyse (Mutant et WildType) proviennent du d√©p√¥t public 'Zenodo'.

Lien du d√©p√¥t :[https://zenodo.org/records/849901](https://zenodo.org/records/849901)
Proc√©dure :T√©l√©chargez les fichiers compress√©s √† partir du lien ci-dessus. 
Apr√®s d√©compression, les fichiers (`mut_lib1_R1.fq.gz`, etc.) doivent √™tre plac√©s dans le dossier 'data/raw/'.

2. Fichiers de R√©f√©rence

Les fichiers de r√©f√©rence pour Drosophila melanogaster (version BDGP6 / Ensembl 110) sont requis pour l'alignement et la quantification.

*G√©nome FASTA (.fa) : T√©l√©chargez la s√©quence du g√©nome.
Nom de fichier attendu : 'Drosophila_melanogaster.BDGP6.dna.toplevle.fa'
*Annotation GTF (.gtf) : T√©l√©chargez le fichier d'annotation.
*Nom de fichier attendu : 'Drosophila_melanogaster.BDGP6.46.110.gtf'

Ces fichiers doivent √™tre plac√©s dans le dossier 'data/reference/'.

---

## ‚öôÔ∏è Configuration et D√©pendances

L'analyse a √©t√© d√©velopp√©e et test√©e sur un environnement Ubuntu/Debian. La reproductibilit√© n√©cessite l'installation des outils suivants.

1. Outils Bio-informatiques de Base (via `apt` et `pip`)

Installez les d√©pendances de base et les outils du pipeline :


# Mettre √† jour les paquets syst√®me
sudo apt update

# Installer Java (n√©cessaire pour Trimmomatic) et les outils essentiels
sudo apt install -y default-jre
sudo apt install -y fastqc     # Contr√¥le Qualit√©
sudo apt install -y samtools   # Manipulation des fichiers BAM/SAM
sudo apt install -y hisat2     # Alignement (si install√© via APT)
sudo apt install -y subread    # Quantification (featureCounts)
sudo apt install -y python3-pip
pip install multiqc    # Agr√©gation des rapports QC (installation via pip, recommand√©)
# Installer R et les outils essentiels (R est n√©cessaire pour Rscript/RStudio)
sudo apt install -y r-base-core 
sudo apt install -y default-jre

# configuration Docker
L'analyse statistique tourne dans un conteneur bas√© sur rocker/rstudio. Ce conteneur inclut :

R v4.x et RStudio Server.

Les d√©pendances syst√®me Linux (libxml2, libxt, etc.) n√©cessaires √† Bioconductor.

Le package DESeq2 pour l'analyse statistique.

##Pr√©requis:
Avoir install√© Docker Desktop.

(Pour Windows) Avoir activ√© le moteur WSL 2.

2. Installation Sp√©cifique de Trimmomatic (v0.39)
Trimmomatic est install√© manuellement et un lien symbolique est cr√©√© pour que le script Bash y acc√®de directement via le chemin /usr/local/bin/trimmomatic.jar.

# T√©l√©charger l'archive
wget (https://github.com/usadellab/Trimmomatic/releases/download/v0.39/trimmomatic-0.39.zip)
unzip trimmomatic-0.39.zip

# D√©placer l'outil et cr√©er le lien symbolique (chemin utilis√© dans le script Bash)
sudo mv trimmomatic-0.39 /opt/trimmomatic
sudo ln -s /opt/trimmomatic/trimmomatic-0.39.jar /usr/local/bin/trimmomatic.jar

# (Optionnel) Ajout d'un alias pour une utilisation manuelle
# echo 'alias trimmomatic="java -jar /usr/local/bin/trimmomatic.jar"' >> ~/.bashrc
# source ~/.bashrc

3. Packages R
Les packages n√©cessaires pour l'analyse statistique sont install√©s via R et le d√©p√¥t Bioconductor.

    ```R
    # Lancer cette commande dans le terminal ou via RStudio :
    if (!requireNamespace("BiocManager", quietly = TRUE))
        install.packages("BiocManager")

    BiocManager::install("DESeq2")
    
    ```

üöÄ Ex√©cution du Pipeline
Le pipeline se lance en trois √©tapes :

√âtape 0 : Pr√©paration des Fichiers de R√©f√©rence
L'index HISAT2 doit √™tre construit manuellement car les fichiers d'index sont trop volumineux pour √™tre inclus dans le d√©p√¥t.

Placement des Fichiers : Assurez-vous que le fichier du g√©nome (Drosophila_melanogaster.BDGP6.dna.toplevle.fa) et l'annotation (.gtf) sont dans data/reference/.

Construction de l'Index : Ex√©cutez la commande suivante depuis le dossier racine du projet. Le script Bash s'attend √† ce que l'index soit nomm√© DM6.
hisat2-build data/reference/Drosophila_melanogaster.BDGP6.dna.toplevel.fa DM6

√âtape 1 : Pr√©paration et Quantification (Script Bash)
Le script Bash (script_rnaseq.sh) g√®re le QC (FastQC, Trimmomatic, MultiQC), l'Alignement (HISAT2) et la Quantification (FeatureCounts).

Placez les fichiers .fastq.gz dans le dossier data/raw/.

Rendez le script ex√©cutable et lancez-le dans le terminal :

chmod +x script_rnaseq.sh
./script_rnaseq.sh

√âtape 2 : Analyse Statistique (Environnement docker)

Pour garantir la reproductibilit√© de l'analyse avec DESeq2 et √©viter les conflits de versions R, la partie statistique est isol√©e dans un conteneur Docker.

#Construction de l'image
Lancez cette commande dans le dossier contenant votre Dockerfile :
docker build -t labo_rnaseq .

#Lancement du conteneur
Liez votre dossier de projet pour que le script R puisse acc√©der √† la matrice de comptage g√©n√©r√©e √† l'√©tape pr√©c√©dente :
docker run -d -p 8787:8787 `
  -e PASSWORD=bioinfo `
  -v "C:\Chemin\Vers\Votre\Projet:/home/rstudio/projet" `
  --name mon_rstudio labo_rnaseq

#Ex√©cution dans RStudio
Connectez-vous sur http://localhost:8787 (User: rstudio / Pass: bioinfo).
Ouvrez le dossier projet/ dans l'onglet Files.
Lancez le script deseq2_analysis.R.

üìà Interpr√©tation des R√©sultats
Observation Statistique
L'analyse diff√©rentielle (Mutant vs WildType) a √©t√© effectu√©e √† l'aide du package DESeq2. Les r√©sultats sugg√®rent un effet de la mutation tr√®s cibl√© et subtil. Au seuil strict (padj < 0.05 et Log2FC > 1), seulement 1 g√®ne a √©t√© identifi√© comme √©tant significativement diff√©rentiellement exprim√© (DEG).

Perspectives Biologiques
Ce r√©sultat robuste mais limit√© indique que l'effet est pr√©cis. La prochaine √©tape essentielle serait de r√©aliser une Analyse d'Enrichissement Fonctionnel (GO/KEGG) pour d√©terminer si les g√®nes DEG ou les candidats faiblement exprim√©s convergent vers une voie biologique sp√©cifique.
